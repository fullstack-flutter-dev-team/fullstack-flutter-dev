## 7월 28일 (월)
---
### ▣▣▣ JDBC 개념 및 환경설정 ▣▣▣
1. JDBC(Java DataBase Connectivity)는 자바 프로그램이
   DBMS에 일관된 방식으로 접근할 수 있도록 API를 제공하는
   자바 클래스들의 모임으로 다음과 같은 특징을 갖는다.
   1) JDBC 는 함수 호출용 SQL 인터페이스
   2) JDBC 는 ANSI SQL-92 표준을 지원
   3) JDBC 는 공통된 SQL 인터페이스를 바탕

    → JDBC란 데이베이스에 연결 및 작업을 하기 위한 자바 표준 인터페이스이다.

2. JDBC 구성
   1) 응용 프로그램
    - 데이터베이스에 연결을 요청
    - 데이터페이스에 SQL문을 전송
    - SQL문의 결과를 요청
    - 오류가 발생하는 경우에 오류 처리
    - 트랜잭션을 제어
    - 연결 종료

   2) 드라이버 매니저
    - 데이터베이스에 맞는 드라이버를 찾는다.
    - JDBC 초기화를 위한 작업을 수행

   3) 드라이버
    - 데이터베이스에 연결
    - 데이터베이스에 SQL문을 전달
    - 응용 프로그램에 검색 결과를 전달
    - 필요한 경우에 커서를 조작
    - 필요한 경우에 트랜잭션을 시작
   4) DBMS
    - 데이터가 저장되어 있는 장소

3. System Architecture
   JDBC API는 2-tier 와 3-tier 를 모두 지원한다.
    - tier : 일련의 유사한 객체가 나열된 상태에서의 열 또는 계층을 
   1) 2-tier (일반적인 C/S 프로그램 구조)
   - 자바 애플릿이나 어플리케이션이 JDBC를 이용하여 DBMS 데이터베이스에 직접 접근
   - 가장 대표적인 클라이언트-서버 구조
   - 보안, 로드 밸런싱, 확장성(오브젝트 재사용) 등의 문제점
   - 2-tier 디자인이 적합한 경우
     - 애플리케이션이 하나의 데이터베이스만을 사용
     - 데이터베이스 엔진이 하나의 CPU에서 동작
     - 데이터베이스가 계속 거의 같은 크기로 유지
     - 사용자 기반이 같은 크기로 유지
     - 요구가 확정되어 변화 가능성이 극히 적거나 없는 경우
     - 애플리케이션을 종료한 후에도 최소한의 지속성을 요구
   
   2) 3-tier
    - 자바 애플리케이션이나 애플릿이 DBMS를 직접 접근하는 것이 아니라, 중간에 미들웨어(미들티어)를 거쳐 데이터베이스에 접근
    - 데이터베이스와의 연동 부분을 분리시킴으로써 Presentation Layer가 데이터 저장 방법에 신경을 쓰지 않아도 된다.
    - 클라이언트는 단지 미들티어를 참조
    - 미들티어 서버는 DBMS와 같이 특정한 작업만 수행하는 최종 서버와 통신을 하여 결과를 얻은 후 클라이언트에 결과를 전달
    - 2-tier 모델버다 안정적이고 유연하며 보안이 강화
      - tier-1 : 사용자 인터페이스를 담당하는 클라이언트
      - tier-2 : HTTP나 코바를 지원하는 응용처리 서버
      - tier-3 : DBMS 와 같이 사용자가 최종적으로 원하는 기능을 수행할 서버

4. JDBC Driver 유형
    1) Type 1 (현재 거의 사용 x)
        - JDBC-ODBC Driver
        - 특징
          - 데이터베이스를 연동하기 위해 브릿지 기술을 사용
          - ODBC API로의 게이트웨이를 제공하여 실제로는 ODBC의 API를 구현함으로써 데이터베이스를 연동
          - 브릿지 솔루션은 보통 클라이언트에 소프트웨가 설치될 것을 요구
          - JDBD-ODBC 드라이버는 ODBC 드라이버가 풍부하기 때문에 거의 대부분 데이터베이스 시스템에서 사용할 수 있으며, JDBD-ODBC 드라이버가 설치되어 있는 경우에 매우 유용하게 사용할 수 있다.
          - 속도와 관련한 가장 큰 문제
            - JDBC를 통해 호출된 명령이 다시 ODBC를 통해 나가야 하기 때문에 두 개의 브릿지를 거치며, 이로 인해 빠른 속도를 기대하기 어렵다. 즉, 빠른 성능을 요구하는 어플리케이션의 경우에는 Type 1. JDBC-ODBC 브릿지는 적당하지 않다.
          - JDBC-ODBC 브릿지를 사용하는 시스템에는 반드시 해당 데이터베이스에 연결하기 위한 ODBC Driver가 설치되어야 하며, 이 단점은 애플릿에서 JDBC를 사용하여 프로그래밍 해야 하는 경우, 많은 문제가 된다. 애플릿을 이용하여 JDBC-ODBC를 사용할 경우, 애플릿을 다운받은 클라이언트에 미리 해당 ODBC Driver가 설치되어 있어야 하기 때문에 배포 등에 많은 문제가 발생하게 된다.
    2) Type 2
      - Native-API / Partly Java Driver(사용 일부 자바)
      - 특징
        - 각각의 데이터베이스 제조업체들이 제공한 C 혹은 C++ 메소드를 자바 코드가 호출하는 방식
        - 부분적으로 자바 드라이버인 원시 API라고 일컬어짐
        - DB와 연결되는 부분이 Native Code 로 구현되어 있는 만큼 JDBD-ODBC 브릿지에 비해 빠른 속도를 제공한다.
        - JDBC Driver 를 사용하고자 하는 각각의 클라이언트에 DBMS Vender의 DB 라이브러리가 로드되어야 하기 때문에 인터넷이나 CS환경에서는 사용하기 적합하지 않다. 또한, Type 3, 4 드라이버에 비해 낮은 성능
    3) Type 3
      - Net-Protocol / All-Java Driver(순수 자바)
      - 클라이언트에서 일반적인 Network API를 이용해 보낸 정보를 서버가 DB에 독점적 형태로 변환하는 방식
      - 특징
        - 클라이언트에 존재하는 JDBC 드라이버는 소켓을 사용하여 서버에 존재하는 미들웨어(Middleware) 애플리캐이션에 연결
        - 애플리케이션은 클라이언트의 요청을 사용하고자 하는 DB에 독점적인 API로 전환
        - 하나의 드라이버로 여러 개의 DB를 연동
        - 클라이언트에 소프트웨어를 설치할 필요가 없음
        - 
    4) Type 4
      - Native-Protocol / All-Java Driver(순수 자바)
      - DB Engine에 사용되는 Network Protocol 을 Java Socket으로 직접 DB에 교신하는 방식
      - 특징
        - 가장 직접적인 순수 자바 솔루션
        - 거의 대부분 DB 제조 업체가 제공한다.
        - ODBC 나 Native Lib. 형태로 request를 변환하지 않기 때문에 Performance 가 매우 좋다.
        - 또한, 특별하게 Driver나 Lib, Middleware등을 설치할 필요가 없기 때문에 배포 등이 매우 용이하다.

5. Oracle JDBC Driver
    1) Type 2
      - 오라클 [OCI Driver] 로 불리운다.
      - OCIx 드라이버 : OracleX DB를 지원하는 구조
      -    8                  8
      -    9                  9
      -    :                  :
      - 이러한 드라이버는 한정된 플랫폼으로 모든 오라클 드라이버는 JDK 1.0과  1.1.X 에 종속적이며 JDBC 1.22 표준을 지원한다.
      - 또한 
    2) Type 4 ★
      - 오라클 [Thin Driver]로 불리운다.
      - 자바로 작성된 Net8의 TCP/IP 버전의 자체적인 
      - 
6. JDBC API
   JDBC API 는 데이터베이스의 데이터를 액세스할 수 있도록 제공되는 표준 자바 API 클래스와 인터페이스로 구성되며, 다음의 기능을 실행하기 위한 클래스와 인터페이스를 제공한다.
   - JAVA 프로그램에서 데이터베이스 서버에 접속하기
   - SQL문을 구성, 데이터베이스 서버에서 실행시키기
   - 데이터베이스 서버가 처리한 결과를 가져오기
   - 데이터베이스의 정보, 처리 결과에 대한 정보 등을 가져오기

---------------------------------------------------------------------
###  ▣▣▣  사전 환경 설정(주의 사항) ▣▣▣▣
---
~~.jar
~~.war
○ 오라클이 설치된 경우
  - 시스템의 classpath 를 다음과 같이 변경
  - (11g Express Edition의 설치 경로가 C:\oraclexe인 경우)
    - .;C:\oraclexe\app\oracle\product\11.2.0\server\jdbc\lib\ojdbc6.jar
  - (10g Enterprise / Standard Edition의 설치 경로가 C:\oracle인 경우)
    - .;C:\oracle\product\10.x.x\db_1\jdbc\lib\ojdbc14.jar


○ 오라클이 설치되어 있지 않은 경우
  - Oracle 용 JDBC 드라이버를 다운로드 해야 한다.
    - 다운로드 경로
      - 『http://www.oracle.com/kr/downloads』 이동
      - 『드라이버 및 유틸리티』 항목으로 페이지 내 스크롤 이동
      -  『JDBC 드라이버』 메뉴 클릭
      -   →  이동
      -   버전에 맞는 JDBC Driver Downloads 항목 클릭
  - 시스템의 classpath에 ojdbc6.jar 또는 ojdbc14.jar 등 버전에 맞는 파일 항목의 경로 추가

--※ 공통 사항(드라이버 설치를 위한 JDBC 드라이버를 다음 두 경로에 복사&붙여넣기)
   1. C:\Program Files\Java\jdk-1.8\jre\lib\ext
   2. C:\Program Files\Java\jre-1.8\lib\ext

--※ 추후 진행하게 될 JSP 실습을 위한 추가 설정
  - 웹 서버에서 실질적으로 Oracle 용 JDBC 드라이버를 찾는 경로는 『톰캣_루트\lib』 이므로 JDBC 드라이버를 이 경로에 복사&붙여넣기 한다.

------------------------------------
--▣  JDBC 프로그래밍 절차
1. 드라이버 로딩 : Class.forName()
   -  Oracle Driver를 Java에서 사용하기 위해 드라이버를 JVM(자바 가상 머신)에 로딩하는 과정.
2. 커넥션 할당받기 : DriverManager.getConnection() → 싱글턴 디자인 패턴
3. 쿼리문 전송을 위해 Statement 또는 PreparedStatement 할당받기
   - conn.createStatement() 또는 conn.preparedStatement(), callableStatement() - 프로시저 호출에 사용
4. Statement 또는 PreparedStatement 를 통한 쿼리문 전송
   - DML(Insert, update, delete) 문인 경우
    - int updateCount = stmt.executeUpdate(sql)
       → 적용된 행의 갯수(레코드 수) 반환
   - select 문인 경우
    - ResultSet rs = stmt.executeQuery(sql)
5. (select 구문의 경우 추가적으로)
   - ResultSet의 논리적 커서 바인딩을 통해 각 컬럼의 데이터를 바인딩 해 온다.
     - boolean b = rs.next()
       → 커서 이동.
         - 커서가 위치한 지점에 레코드가 존재하면 true를 반환, 없으면 false를 반환한다.
         - 커서는 가장 선두 첫 번째 레코드의 직전에 위치하고 있다가 next()가 호출되면 진행한다.
6. 사용을 마친 리소스 반납
  rs.close();
  stmt.close();
  dbConn.close();
  (null 체크하여 close() 해주는 것을 권장, finally 블럭에서 구현하는 것을 권장)


-----------------------------------------------------------------------------------------------------------------
-- ### --▣ --※ ○ ★ 『』 ? ▣ ◀▶ ▼ ▲ ⓐ ⓑ ① ② ③ ④ ⑤ ⑥ ⑦ ⑧ ⑨ ⑩  →   ←  ↓  …  ： º↑ /* */  ─ ┃ ┛┯ ┐┘ ￦
--/*▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼*/
--/*================[ 7월 XX일(금) ]========================*/

-----------------[ 강사님 풀이 - START ] ------------------------------
-----------------[ 강사님 풀이 - END ] --------------------------------

-----------------[ 실습 - START ] ----------------------------
-----------------[ 실습 - END ] ------------------------------
