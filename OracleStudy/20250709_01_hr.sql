--▣ 접속된 사용자 확인
SELECT USER
FROM DUAL;
--==>>  HR

--▣ HR 계정 소유의 테이블 또는 뷰 목록 조회
SELECT *
FROM TAB;
/*

TNAME                          TABTYPE  CLUSTERID
------------------------------ ------- ----------
COUNTRIES                      TABLE             
DEPARTMENTS                    TABLE             
EMPLOYEES                      TABLE             
EMP_DETAILS_VIEW               VIEW              
JOBS                           TABLE             
JOB_HISTORY                    TABLE             
LOCATIONS                      TABLE             
REGIONS                        TABLE   
*/
-----------------------------------------------------------


--▣▣▣  PRIMARY KEY ▣▣▣--
--  1. 테이블에 대한 기본키를 생성한다.
--  2. 테이블에서 각 행을 유일하게 식별하는 컬럼(단일 P.K) 또는 컬럼의 집합(복합P.K)이다.
--     기본 키는 테이블 당 최대 하나만 존재한다.
--     그러나, 반드시 하나의 컬럼으로만 구성되는 것은 아니다.
--     NULL 일 수 없고, 이미 테이블에 존재하고 있는 데이터를
--     다시 입력하거나 수정할 수 없도록 처리된다.
--     UNIQUE INDEX 가 자동으로 생성된다.(빠른 검색을 위해...)
--      (오라클이 자체적으로 만든다.)
--
--  3. 형식 및 구조  
--      ① 컬럼 레벨의 형식 ★★★
--      컬럼명 데이터타입 [CONSTRAINT CONSTRAINT명] PRIMARY KEY[(컬럼명, ...)]
--      
--      ② 테이블 레벨의 형식(협업 작업시 권장...) ★★★★
--        컬럼명 데이터타입,
--        컬럼명 데이터타입,
--        CONSTRAINT CONSTRAINT명 PRIMARY KEY(컬럼명[, ...])
--      
--  4. CONSTRAINT 추가 시 CONSTRAINT 명을 생략하면
--     오라클 서버가 자동적으로 CONSTRAINT 명을 부여하게 된다.
--     일반적으로 CONSTRAINT 명은 『테이블명_컬럼명_CONSTRAINT약어』
--     형식으로 기술한다.
--------------------------------------------------------------------
--○ PK 지정 실습 ( ① 컬럼 레벨의 형식)
--- 테이블 생성
CREATE TABLE TBL_TEST1
( COL1 NUMBER(5)       PRIMARY KEY
, COL2 VARCHAR2(30)
);
-- ==>> Table TBL_TEST1이(가) 생성되었습니다.

-- 데이터 입력
INSERT INTO TBL_TEST1(COL1, COL2) VALUES(1, 'TEST');
INSERT INTO TBL_TEST1(COL1, COL2) VALUES(2, 'ABCD');
INSERT INTO TBL_TEST1(COL1, COL2) VALUES(3, NULL); -- 동일 쿼리
INSERT INTO TBL_TEST1(COL1) VALUES(4);--------------- 동일 쿼리
INSERT INTO TBL_TEST1(COL1, COL2) VALUES(2, 'ABCD'); --> 에러 발생
INSERT INTO TBL_TEST1(COL1, COL2) VALUES(2, 'KKK'); --> 에러 발생
INSERT INTO TBL_TEST1(COL1, COL2) VALUES(5, 'ABCD');
INSERT INTO TBL_TEST1(COL1, COL2) VALUES(NULL, NULL);--> 에러 발생
INSERT INTO TBL_TEST1(COL1, COL2) VALUES(NULL, 'STUDY');--> 에러 발생
INSERT INTO TBL_TEST1(COL2) VALUES('STUDY');--> 에러 발생

-- 커밋
COMMIT;
-- ==>> 커밋 완료.


--확인
SELECT *
FROM TBL_TEST1;
/*
  COL1 COL2  
------ ------
     1 TEST  
     2 ABCD  
     3       
     4       
     5 ABCD 
*/

-- 구조 확인
DESCRIBE TBL_TEST1;
/*
이름   널?       유형           
---- -------- ------------ 
COL1 NOT NULL NUMBER(5)      →  PK 제약 확인 불가
COL2          VARCHAR2(30) 
*/

--▣ 제약조건 확인
SELECT *
FROM USER_CONSTRAINTS
WHERE TABLE_NAME='TBL_TEST1';
/*
OWNER                          CONSTRAINT_NAME                C TABLE_NAME                     SEARCH_CONDITION                                                                 R_OWNER                        R_CONSTRAINT_NAME              DELETE_RU STATUS   DEFERRABLE     DEFERRED  VALIDATED     GENERATED      BAD RELY LAST_CHA INDEX_OWNER                    INDEX_NAME                     INVALID VIEW_RELATED  
------------------------------ ------------------------------ - ------------------------------ -------------------------------------------------------------------------------- ------------------------------ ------------------------------ --------- -------- -------------- --------- ------------- -------------- --- ---- -------- ------------------------------ ------------------------------ ------- --------------
HR                             SYS_C007059                    P TBL_TEST1                                                                                                                                                                               ENABLED  NOT DEFERRABLE IMMEDIATE VALIDATED     GENERATED NAME          09/07/25 HR                             SYS_C007059                                          
*/

--▣ 제약조건이 지정된 컬럼 확인(조회)
SELECT *
FROM USER_CONS_COLUMNS
WHERE TABLE_NAME='TBL_TEST1';
/*
OWNER                          CONSTRAINT_NAME                TABLE_NAME                     COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        POSITION
------------------------------ ------------------------------ ------------------------------ ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------
HR                             SYS_C007059                    TBL_TEST1                      COL1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1
*/



--▣ 제약조건이 설정된 소유주, 제약명, 테이블명, 제약종류, 컬럼명 항목 조회
--   SELECT 소유주, 제약명, 테이블명, 제약종류, 컬럼명
--   FROM USER_CONSTRAINTS US, USER_CONS_COLUMNS UCC
--   WHERE US.CONSTRAINT_NAME = UCC.CONSTRAINT_NAME;

SELECT UC.OWNER 소유주, UC.CONSTRAINT_NAME 제약명
     , UC.TABLE_NAME 테이블명
     , UC.CONSTRAINT_TYPE 제약종류
     , UCC.COLUMN_NAME 컬럼명
FROM USER_CONSTRAINTS UC, USER_CONS_COLUMNS UCC
WHERE UC.CONSTRAINT_NAME = UCC.CONSTRAINT_NAME
  AND UC.TABLE_NAME= 'TBL_TEST1';
/*

소유주                            제약명                            테이블명                           제 컬럼명                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
------------------------------ ------------------------------ ------------------------------ - ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
HR                             SYS_C007059                    TBL_TEST1                      P COL1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
*/


-----------------------------------------------------------------------------------------
--○ PK 지정 실습(② 테이블 레벨의 형식)
--- 테이블 생성
CREATE TABLE TBL_TEST2
( COL1 NUMBER(5) 
, COL2 VARCHAR2(30)
, CONSTRAINT TEST2_COL1_PK PRIMARY KEY(COL1)
);
--==>>  Table TBL_TEST2이(가) 생성되었습니다.

-- 데이터 입력
INSERT INTO TBL_TEST2(COL1, COL2) VALUES(1, 'TEST');
INSERT INTO TBL_TEST2(COL1, COL2) VALUES(2, 'ABCD');
INSERT INTO TBL_TEST2(COL1, COL2) VALUES(3, NULL); -- 동일 쿼리
INSERT INTO TBL_TEST2(COL1) VALUES(4);--------------- 동일 쿼리
INSERT INTO TBL_TEST2(COL1, COL2) VALUES(2, 'ABCD'); --> 에러 발생
-- ==>> 오류 보고 - ORA-00001: unique constraint (HR.TEST2_COL1_PK) violated
INSERT INTO TBL_TEST2(COL1, COL2) VALUES(2, 'KKK'); --> 에러 발생
-- ==>> 오류 보고 - ORA-00001: unique constraint (HR.TEST2_COL1_PK) violated
INSERT INTO TBL_TEST2(COL1, COL2) VALUES(5, 'ABCD');
INSERT INTO TBL_TEST2(COL1, COL2) VALUES(NULL, NULL);--> 에러 발생
INSERT INTO TBL_TEST2(COL1, COL2) VALUES(NULL, 'STUDY');--> 에러 발생
INSERT INTO TBL_TEST2(COL2) VALUES('STUDY');--> 에러 발생

--▣ 커밋
COMMIT;
-- ==>> 커밋 완료.

--▣ 확인
SELECT *
FROM TBL_TEST2;
/*

      COL1 COL2                          
---------- ------------------------------
         1 TEST                          
         2 ABCD                          
         4                               
         5 ABCD        
*/


--▣ 제약조건이 설정된 소유주, 제약명, 테이블명, 제약종류, 컬럼명 항목 조회
-- SELECT 소유주, 제약명, 테이블명, 제약종류, 컬럼명
-- FROM USER_CONSTRAINTS US, USER_CONS_COLUMNS UCC
-- WHERE US.CONSTRAINT_NAME = UCC.CONSTRAINT_NAME;

SELECT UC.OWNER 소유주, UC.CONSTRAINT_NAME 제약명
     , UC.TABLE_NAME 테이블명
     , UC.CONSTRAINT_TYPE 제약종류
     , UCC.COLUMN_NAME 컬럼명
FROM USER_CONSTRAINTS UC, USER_CONS_COLUMNS UCC
WHERE UC.CONSTRAINT_NAME = UCC.CONSTRAINT_NAME
  AND UC.TABLE_NAME= 'TBL_TEST2';
/*
소유주             제약명                 테이블명           제 컬럼명            
--------------- ------------------- ---------------------- - ---------------
HR              TEST2_COL1_PK       TBL_TEST2              P COL1           
*/


-----------------------------------------------------------------------------
--▣ PK 지정 실습 ( ③ 다중 컬럼 PK지정  →  복합 프라이머리 키)
--- 테이블 생성
CREATE TABLE TBL_TEST3
( COL1 NUMBER(5) 
, COL2 VARCHAR2(30)
, CONSTRAINT TEST3_COL1_COL2_PK PRIMARY KEY(COL1, COL2)
-- , CONSTRAINT TEST3_COL1_COL2_PK PRIMARY KEY(COL1) -- PK 1개 (X)
-- , CONSTRAINT TEST3_COL1_COL2_PK PRIMARY KEY(COL2) -- PK 1개 (X)
);
-- ==>> Table TBL_TEST3이(가) 생성되었습니다.

-- (X) CHECK~!!!
--      CREATE TABLE TBL_TEST3
--      ( COL1 NUMBER(5) 
--      , COL2 VARCHAR2(30)
--      , CONSTRAINT TEST3_COL1_COL2_PK PRIMARY KEY(COL1) -- PK 1개 (X)
--      , CONSTRAINT TEST3_COL1_COL2_PK PRIMARY KEY(COL2) -- PK 1개 (X)
--      );

-- 데이터 입력 (★ COL1, COL2 모두 일치하는 경우만 입력 불가능.... ★ 개별)
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(1, 'TEST');
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(2, 'ABCD');
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(3, NULL); -- 동일 쿼리  --> 에러 발생
INSERT INTO TBL_TEST3(COL1) VALUES(4);  ------------- 동일 쿼리  --> 에러 발생
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(2, 'ABCD'); --> 에러 발생
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(3, 'ABCD'); --> ★★ CHECK~!!  가능...
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(1, 'ABCD'); --> ★★ CHECK~!!  가능...
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(2, 'KKK'); --> ★★ CHECK~!!  가능...
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(4, 'ABCD'); --> ★★ CHECK~!!  가능...
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(NULL, NULL); --> 에러 발생
INSERT INTO TBL_TEST3(COL1, COL2) VALUES(NULL, 'STUDY'); --> 동일커리 - 에러 발생
INSERT INTO TBL_TEST3(COL2) VALUES('STUDY');---------------> 동일커리 - 에러 발생


--▣ 커밋
COMMIT;
-- ==>> 커밋 완료.

--▣ 확인
SELECT *
FROM TBL_TEST3;
/*

      COL1 COL2                          
---------- ------------------------------
         1 ABCD                          
         1 TEST                          
         2 ABCD                          
         2 KKK                           
         3 ABCD                          
         4 ABCD                          

6개 행이 선택되었습니다. 
*/


---------------------------------------------------------------------
--▣ PK 지정 실습 (④ 테이블 생성 이후 제약조건 추가 -> PK지정)
--- 테이블 생성
CREATE TABLE TBL_TEST4
( COL1 NUMBER(5) 
, COL2 VARCHAR2(30)
);
-- ==>> Table TBL_TEST4이(가) 생성되었습니다.

--※ 이미 만들어져 있는 테이블에
---  부여하려는 제약조건을 위반한 데이터가 포함되어 있을 경우
---  해당 테이블에 제약조건을 추가하는 것은 불가능하다.

--▣ 제약조건 추가 ( 테이블 구조 변경...)
ALTER TABLE TBL_TEST4
ADD CONSTRAINT TEST4_COL1_PK PRIMARY KEY(COL1);
-- ==>> Table TBL_TEST4이(가) 변경되었습니다.

--※ 제약조건 확인 전용 뷰(VIEW) 생성
-- FROM USER_CONSTRAINTS UC JOIN USER_CONS_COLUMNS UCC

-- 뷰명 : VIEW_CONSTCHECK
CREATE OR REPLACE VIEW VIEW_CONSTCHECK
AS
SELECT UC.OWNER "OWNER"
     , UC.CONSTRAINT_NAME "CONSTRAINT_NAME"
     , UC.TABLE_NAME "TABLE_NAME"
     , UC.CONSTRAINT_TYPE "CONSTRAINT_TYPE"
     , UCC.COLUMN_NAME "COLUMN_NAME"
     , UC.SEARCH_CONDITION "SEARCH_CONDITION"
     , UC.DELETE_RULE "DELETE_RULE"  -- 삭제 룰
FROM USER_CONSTRAINTS UC JOIN USER_CONS_COLUMNS UCC
ON UC.CONSTRAINT_NAME = UCC.CONSTRAINT_NAME;
-- ==>> View VIEW_CONSTCHECK이(가) 생성되었습니다.

--▣ 생성된 뷰(VIEW)를 통한 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME = 'TBL_TEST4';
/*
OWNER     CONSTRAINT_NAME      TABLE_NAME    C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   SEARCH_CONDITION                                                                 DELETE_RU
--------- -------------------- ------------- - --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR        TEST4_COL1_PK        TBL_TEST4     P COL1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
*/

------------------------------------------------------------------------------
--▣▣▣  UNIQUE(UK:U) ▣▣▣--
--- 1. 테이블에서 지정한 컬럼의 데이터가 중복되지 않고
--     테이블 내에서 유일할 수 있도록 설정하는 제약조건.
--     PRIMARY KEY 와 유사한 제약조건이지만, NULL을 허용한다는 차이가 있다.
--     내부적으로 PRIMARY KEY와 마찬가지로 UNIQUE INDEX가 자동 생성된다.
--     하나의 테이블 내에서 UNIQUE 제약조건은 여러 번 설정하는 것이 가능하다.
--     즉, 하나의 테이블에 UNIQUE 제약조건을 여러 개 만드는 것이 가능하다는 것이다.
   
--- 2. 형식 및 구조
--     ① 컬럼 레벨의 형식
--       컬럼명 데이터타입 [CONSTRAINT CONSTRAINT명] UNIQUE
--       
--     ② 테이블 레벨의 형식
--       컬럼명 데이터타입,
--       컬럼명 데이터타입,
--       CONSTRAINT CONSTRAINT명 UNIQUE(컬럼명[, ...])
  
--▣ UK 지정 실습 (① 컬럼 레벨의 형식)
--- 테이블 생성
CREATE TABLE TBL_TEST5
( COL1 NUMBER(5)      PRIMARY KEY
, COL2 VARCHAR2(30)   UNIQUE
);
-- ==> Table TBL_TEST5이(가) 생성되었습니다.


-- 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST5';

-- 데이터 입력
INSERT INTO TBL_TEST5(COL1, COL2) VALUES(1, 'TEST');
INSERT INTO TBL_TEST5(COL1, COL2) VALUES(2, 'ABCD');
INSERT INTO TBL_TEST5(COL1, COL2) VALUES(3, NULL); 
INSERT INTO TBL_TEST5(COL1) VALUES(4);
INSERT INTO TBL_TEST5(COL1, COL2) VALUES(5, 'ABCD'); --> 에러 발생
INSERT INTO TBL_TEST5(COL1, COL2) VALUES(5, NULL);


--▣ 커밋
COMMIT;
-- ==>> 커밋 완료.

--▣ 확인
SELECT *
FROM TBL_TEST5;
/*
     COL1 COL2                          
---------- ------------------------------
         1 TEST                          
         2 ABCD                          
         3                               
         4                               
         5                               
*/

--▣ UK 지정 실습 (② 테이블 레벨의 형식)
--- 테이블 생성
CREATE TABLE TBL_TEST6
( COL1 NUMBER(5)  
, COL2 VARCHAR2(30)
, CONSTRAINT TEST6_COL1_PK PRIMARY KEY (COL1)
, CONSTRAINT TEST6_COL2_UK UNIQUE (COL2)
);

--▣ UK 지정 실습 (③ 테이블 생성 이후 제약조건 추가)
--- 테이블 생성
CREATE TABLE TBL_TEST7
( COL1 NUMBER(5)  
, COL2 VARCHAR2(30)
);
--==>> Table TBL_TEST7이(가) 생성되었습니다.

--▣ 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST7';
-- ==>> 선택된 행 없음

--▣ 제약조건 설정(추가)
ALTER TABLE TBL_TEST7
ADD 
(
  CONSTRAINT TEST7_COL1_PK PRIMARY KEY (COL1)
, CONSTRAINT TEST7_COL2_UK UNIQUE(COL2)
)
-- ==>> Table TBL_TEST7이(가) 변경되었습니다.

--▣ 추가 후 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST7';
/*

OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             TEST7_COL1_PK                  TBL_TEST7                      P COL1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
HR                             TEST7_COL2_UK                  TBL_TEST7                      U COL2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
*/

-------------------------------------------------------------------------
--▣▣▣  CHECK(CK:C) ▣▣▣----
-- 1. 컬럼에서 허용 가능한 데이터의 범위나 조건을 지정하기 위한 제약조건,
--    컬럼에 입력되는 데이터를 검사하여 조건에 맞는 데이터만 입력될 수 있도록
--    처리하며, 수정되는 데이터 또한 검사하여 조건에 맞는 데이터로 수정되는 것만
--    허용하는 기능을 수행하게 된다.

-- 2. 형식 및 구조
--    ① 컬럼 레벨의 형식
--      컬럼명 데이터타입 [CONSTRAINT CONSTRAINT명] CHECK(컬럼 조건)
   
--    ② 테이블 레벨의 형식
--      컬럼명 데이터타입,
--      컬럼명 데이터타입,
--      CONSTRAINT CONSTRAINT명 CHECK(컬럼 조건)
   
--※ NUMBER(?????)
--※ NUMBER(38) 까지.... == COL1 NUMBER → NUMBER(38)
--※ CHAR(2000) 까지.... == COL2 CHAR   → CHAR(1)
--※ NCHAR(1000) 까지....
--※ VARCHAR2(4000) 까지....
--※ NVARCHAR2(2000) 까지....

-- CHECK~!!!
-- COL1 NUMBER → NUMBER(38)
-- COL2 CHAR   → CHAR(1)
--- NUMBER(3) → -999 ~ 999

--▣ CK 지정 실습 (① 컬럼 레벨의 형식)
--- 테이블 생성
CREATE TABLE TBL_TEST8
( COL1 NUMBER(5)        PRIMARY KEY
, COL2 VARCHAR2(30)     
, COL3 NUMBER(3)        CHECK(COL3 BETWEEN 0 AND 100)
);
-- ==>> Table TBL_TEST8이(가) 생성되었습니다.

-- 데이터 입력
INSERT INTO TBL_TEST8(COL1, COL2, COL3) VALUES(1, '한국', 100);
INSERT INTO TBL_TEST8(COL1, COL2, COL3) VALUES(2, '미국', 101); -- ==> 에러발생
-- 오류 보고 - ORA-02290: check constraint (HR.SYS_C007069) violated

INSERT INTO TBL_TEST8(COL1, COL2, COL3) VALUES(3, '영국', 80);
INSERT INTO TBL_TEST8(COL1, COL2, COL3) VALUES(4, '호주', -10); -- ==> 에러발생
-- 오류 보고 - ORA-02290: check constraint (HR.SYS_C007069) violated

--▣ 커밋
COMMIT;
-- ==>> 커밋 완료.

--▣ 확인
SELECT *
FROM TBL_TEST8;
/*
      COL1 COL2                                 COL3
---------- ------------------------------ ----------
         1 한국                                  100
         3 영국                                   80
*/


--▣ 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST8';
/*

OWNER           CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME      SEARCH_CONDITION                                                                 DELETE_RU
--------------- ------------------------------ ------------------------------ - ---------------- -------------------------------------------------------------------------------- ---------
HR              SYS_C007069                    TBL_TEST8                      C COL3             COL3 BETWEEN 0 AND 100                                                                    
HR              SYS_C007070                    TBL_TEST8                      P COL1                                                                                                       
*/

--▣ CK 지정 실습 ( ② 테이블 레벨의 형식)
--- 테이블 생성
CREATE TABLE TBL_TEST9
( COL1 NUMBER(5)  
, COL2 VARCHAR2(30)     
, COL3 NUMBER(3)
, CONSTRAINT TEST9_COL1_PK PRIMARY KEY(COL1)
, CONSTRAINT TEST9_COL3_CK CHECK(COL3 BETWEEN 0 AND 100)
);
-- ==>> Table TBL_TEST9이(가) 생성되었습니다.


-- 데이터 입력
INSERT INTO TBL_TEST9(COL1, COL2, COL3) VALUES(1, '한국', 100);
INSERT INTO TBL_TEST9(COL1, COL2, COL3) VALUES(2, '미국', 101); -- ==> 에러발생
-- 오류 보고 - ORA-02290: check constraint (HR.TEST9_COL3_CK) violated

INSERT INTO TBL_TEST9(COL1, COL2, COL3) VALUES(3, '영국', 80);
INSERT INTO TBL_TEST9(COL1, COL2, COL3) VALUES(4, '호주', -10); -- ==> 에러발생
-- 오류 보고 - ORA-02290: check constraint (HR.TEST9_COL3_CK) violated

--▣ 커밋
COMMIT;
-- ==>> 커밋 완료.

--▣ 확인
SELECT *
FROM TBL_TEST9;
/*

      COL1 COL2                                 COL3
---------- ------------------------------ ----------
         1 한국                                  100
         3 영국                                   80

*/

--▣ 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST9';
/*
OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             TEST9_COL3_CK                  TBL_TEST9                      C COL3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             COL3 BETWEEN 0 AND 100                                                                    
HR                             TEST9_COL1_PK                  TBL_TEST9                      P COL1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
*/

--------------------------------------
--▣ CK 지정 실습 (③ 테이블 생성 이후 제약조건 추가)
--- 테이블 생성
CREATE TABLE TBL_TEST10
( COL1 NUMBER(5)  
, COL2 VARCHAR2(30)     
, COL3 NUMBER(3)  
);
-- Table TBL_TEST10이(가) 생성되었습니다.


--▣ 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST10';
-- ==>> 선택된 행 없음


--▣ 이미 생성되어 있는 기존 테이블에 제약조건 추가
ALTER TABLE TBL_TEST10
ADD
(
  CONSTRAINT TEST10_COL1_PK PRIMARY KEY(COL1)
 ,CONSTRAINT TEST10_COL3_CK CHECK(COL3 BETWEEN 0 AND 100) 
);
-- ==> Table TBL_TEST10이(가) 변경되었습니다.

--▣ 제약조건 추가 후 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST10';
/*
OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             TEST10_COL1_PK                 TBL_TEST10                     P COL1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
HR                             TEST10_COL3_CK                 TBL_TEST10                     C COL3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             COL3 BETWEEN 0 AND 100                                                                    
*/

--▣ 실습을 위한 추가 테이블 생성
-- 테이블명 : TBL_TESTMEMBER
CREATE TABLE TBL_TESTMEMBER
( SID NUMBER(5)  
, NAME VARCHAR2(30)     
, SSN CHAR(14)        -- 입력 형태 -> 'YYMMDD-NNNNNNNN'  
, TEL VARCHAR2(40)     
);
-- ==>> Table TBL_TESTMEMBER이(가) 생성되었습니다.

-- TBL_TESTMEMBER 테이블의 SSN(주민등록번호) 컬럼에서
-- 데이터 입력 및 수정 시 성별이 유효한 데이터만 처리될 수 있도록
-- 체크 제약조건을 추가할 수 있도록 한다.
--  --> 성별이 유효한 데이터 -> 특정 자리 1,2,3,4 허용
--  또한, SID 컬럼에는 PRIMARY KEY 제약조건을 설정할 수 있도록 한다.

-----------------[ 강사님 풀이 - START ] ------------------------------
-- 제약조건 추가
-- ALTER TABLE TBL_TESTMEMBER
-- ADD
-- (
--    CONSTRAINT TESTMEMBER_SID_PK PRIMARY KEY(SID)
-- ,  CONSTRAINT TESTMEMBER_SSN_CK CHECK()
-- )

-- ALTER TABLE TBL_TESTMEMBER
-- ADD
-- (
--    CONSTRAINT TESTMEMBER_SID_PK PRIMARY KEY(SID)
-- ,  CONSTRAINT TESTMEMBER_SSN_CK CHECK(주민번호 8번째자리 1개가 '1', '2', '3', '4')
-- )

ALTER TABLE TBL_TESTMEMBER DROP CONSTRAINT TESTMEMBER_SID_PK;
ALTER TABLE TBL_TESTMEMBER DROP CONSTRAINT TESTMEMBER_SSN_CK;


ALTER TABLE TBL_TESTMEMBER
ADD
(
   CONSTRAINT TESTMEMBER_SID_PK PRIMARY KEY(SID)
,  CONSTRAINT TESTMEMBER_SSN_CK CHECK(SUBSTR(SSN, 8, 1) IN (1,2,3,4))
)

-----------------[  강사님 풀이 - END  ] ------------------------------

-----------------[ 실습 - START ] ----------------------------
--▣ 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TESTMEMBER';
-- ==>> 선택된 행 없음

DROP TABLE TBL_TESTMEMBER;

ALTER TABLE TBL_TESTMEMBER
ADD
(
   CONSTRAINT TESTMEMBER_SID_PK PRIMARY KEY(SID)
,  CONSTRAINT TESTMEMBER_SSN_CK CHECK(SUBSTR(SSN,8,1) IN (1,2,3,4))
)
-- ==>> Table TBL_TESTMEMBER이(가) 변경되었습니다.


--▣ 제약조건 추가 후 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TESTMEMBER';
/*

OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             TESTMEMBER_SID_PK              TBL_TESTMEMBER                 P SID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
HR                             TESTMEMBER_SSN_CK              TBL_TESTMEMBER                 C SSN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              SUBSTR(SSN, 8, 1) IN (1,2,3,4)                                                            
*/

-- 데이터 입력
INSERT INTO TBL_TESTMEMBER(SID, NAME, SSN, TEL) VALUES(1, '한국', '123456-7895432', '010-1234-5678');
-- 오류 보고 - ORA-02290: check constraint (HR.TESTMEMBER_SSN_CK) violated

INSERT INTO TBL_TESTMEMBER(SID, NAME, SSN, TEL) VALUES(1, '한국', '123456-1895432', '010-1234-5678');
--==>> 1 행 이(가) 삽입되었습니다.

INSERT INTO TBL_TESTMEMBER(SID, NAME, SSN, TEL) VALUES(1, '미국', '123456-1895432', '010-1234-5678');
-- 오류 보고 - ORA-00001: unique constraint (HR.TESTMEMBER_SID_PK) violated

INSERT INTO TBL_TESTMEMBER(SID, NAME, SSN, TEL) VALUES(2, '미국', '123456-7895432', '010-1234-5678');
-- 오류 보고 - ORA-02290: check constraint (HR.TESTMEMBER_SSN_CK) violated

--▣ SSN 컬럼에 UNIQUE 제약조건 추가
ALTER TABLE TBL_TESTMEMBER
ADD
(
   CONSTRAINT TESTMEMBER_SSN_UK UNIQUE(SSN)
)
-- ==>> Table TBL_TESTMEMBER이(가) 변경되었습니다.

--▣ SSN에 UNIQUE 제약조건 추가 후 제약조건 조회
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TESTMEMBER';
/*

OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             TESTMEMBER_SID_PK              TBL_TESTMEMBER                 P SID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
HR                             TESTMEMBER_SSN_CK              TBL_TESTMEMBER                 C SSN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              SUBSTR(SSN, 8, 1) IN (1,2,3,4)                                                            
HR                             TESTMEMBER_SSN_UK              TBL_TESTMEMBER                 U SSN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
*/

-- 데이터 입력
INSERT INTO TBL_TESTMEMBER(SID, NAME, SSN, TEL) VALUES(2, '미국', '123456-1895432', '010-1234-5678');
-- 오류 보고 - ORA-00001: unique constraint (HR.TESTMEMBER_SSN_UK) violated

INSERT INTO TBL_TESTMEMBER(SID, NAME, SSN, TEL) VALUES(2, '미국', '123456-2895432', '010-1234-5678');
-- ==>>  1 행 이(가) 삽입되었습니다.

--▣ 데이터 확인
SELECT *
FROM TBL_TESTMEMBER;
/*

       SID NAME                           SSN            TEL                                     
---------- ------------------------------ -------------- ----------------------------------------
         1 한국                           123456-1895432 010-1234-5678                           
         2 미국                           123456-2895432 010-1234-5678                           
*/
-----------------[  실습 - END  ] ----------------------------


--▣▣▣  FORIGN KEY(FK:F:R) ▣▣▣--
--- 1. 참조 키 또는 외래 키(FK)는
--    두 테이블의 데이터 간 연결을 설정하고
--    강제 적용시키는데 사용되는 열이다.
--    한 테이블의 기본 키 값이 있는 열을
--    다른 테이블에 추가하면 테이블 간 연결을 설정할 수 있다.
--    이 때, 두 번째 테이블에 추가되는 열이 외래 키가 된다.
   
--- 2. 부모 테이블(참조받는 컬럼이 포함된 테이블)이 먼저 생성된 후
--    자식 테이블(참조하는 컬럼이 포함된 테이블)이 생성되어야 한다.
--    이 때, 자식 테이블에 FOREIGN KEY 제약조건이 설정된다.
   
--- 3. 형식 및 구조
--     ① 컬럼 레벨의 형식
--       컬럼명 데이터타입 [CONSTRAINT CONSTRAINT명]
--                        REFERENCES 참조테이블명(참조컬럼명) 
--                        [ON DELETE CASCADE | ON DELETE SET NULL] 
--     ② 테이블 레벨의 형식
--       컬럼명 데이터타입,
--       컬럼명 데이터타입,
--       CONDTRAINT CONSTRAINT명 FOREIGN KEY(컬럼명)
--                  REFERENCES 참조테이블명(참조컬럼명) 
--                 [ON DELETE CASCADE | ON DELETE SET NULL] 

--- 4. FOREIGN KEY 생성 시 주의사항
--     - 참조하고자 하는 부모 테이블을 먼저 생성해야 한다.
--     - 참조하고자 하는 컬럼이 PRIMARY KEY 나 UNIQUE 제약조건이 있어야 한다.
--     - 테이블 간에 PRIMARY KEY 와 FOREIGN KEY 가 정의되어 있으면
--       PRIMARY KEY 제약조건이 설정된 컬럼의 데이터 삭제 시
--       FOREIGN KEY 컬럼에 그 값이 입력되어 있는 경우 삭제되지 않는다.
--        (단, FK 설정 과정에서 『ON DELETE CASCADE』 나 『ON DELETE SET NULL』옵션을
--          사용하여 설정한 경우에는 삭제가 가능하다. )
--     - 부모 테이블을 제거하기 위해서는 자식 테이블을 먼저 제거해야 한다.    

--※ FOREIGN KEY 제약조건을 설정하는 실습을 진행하기 위해서는
--   독립적인 하나의 테이블을 생성하여 처리하는 것이 아니라
--   부모 테이블 생성 작업을 먼저 수행해야 한다.
--   그리고 이 때, 부모 테이블에는 반드시 PK 또는 UK 제약조건이
--   설정된 컬럼이 존재해야 한다.


--○ 부모 테이블 생성
---  테이블명 : TBL_JOBS
CREATE TABLE TBL_JOBS
(
  JIKWI_ID NUMBER(5)
, JIKWI_NAME VARCHAR2(30)
, CONSTRAINT JOBS_ID_PK PRIMARY KEY(JIKWI_ID)
);
-- Table TBL_JOBS이(가) 생성되었습니다.


-- 부모 테이블에 데이터 입력
INSERT INTO TBL_JOBS(JIKWI_ID, JIKWI_NAME) VALUES(1, '사원');
INSERT INTO TBL_JOBS(JIKWI_ID, JIKWI_NAME) VALUES(2, '대리');
INSERT INTO TBL_JOBS(JIKWI_ID, JIKWI_NAME) VALUES(3, '과장');
INSERT INTO TBL_JOBS(JIKWI_ID, JIKWI_NAME) VALUES(4, '부장');
-- ==>> 1 행 이(가) 삽입되었습니다.

--
COMMIT;
-- 커밋 완료.

--○ FK 지정 실습 ( ① 컬럼 레벨의 형식)
CREATE TABLE TBL_EMP1
(
     SID  NUMBER(5)  PRIMARY KEY
   , NAME VARCHAR2(30)
   , JIKWI_ID NUMBER(5) REFERENCES TBL_JOBS(JIKWI_ID) 
);
-- ==> Table TBL_EMP1이(가) 생성되었습니다.


-- 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_EMP1';

/*

OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             SYS_C007086                    TBL_EMP1                       P SID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
HR                             SYS_C007087                    TBL_EMP1                       R JIKWI_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          NO ACTION
*/


-- 자식 테이블에 데이터 입력
INSERT INTO TBL_EMP1(SID, NAME, JIKWI_ID) VALUES(1, '마이콜', 1);
INSERT INTO TBL_EMP1(SID, NAME, JIKWI_ID) VALUES(2, '도우너', 2);
INSERT INTO TBL_EMP1(SID, NAME, JIKWI_ID) VALUES(3, '희동이', 3);
INSERT INTO TBL_EMP1(SID, NAME, JIKWI_ID) VALUES(4, '고길동', 4);
INSERT INTO TBL_EMP1(SID, NAME, JIKWI_ID) VALUES(5, '둘리', 5); -->> 에러 발생 
INSERT INTO TBL_EMP1(SID, NAME, JIKWI_ID) VALUES(5, '둘리', 1); 
INSERT INTO TBL_EMP1(SID, NAME) VALUES(6, '또치'); 
INSERT INTO TBL_EMP1(SID, NAME, JIKWI_ID) VALUES(7, '철수', NULL); 

--○ FK 지정 실습 (②  테이블 레벨의 형식)
CREATE TABLE TBL_EMP2
(
     SID  NUMBER(5)  
   , NAME VARCHAR2(30)
   , JIKWI_ID NUMBER(5) 
   , CONSTRAINT EMP2_SID_PK PRIMARY KEY(SID) 
   , CONSTRAINT EMP2_JIKWI_ID_FK FOREIGN KEY(JIKWI_ID) 
                         REFERENCES TBL_JOBS(JIKWI_ID) 
);
-- ==>  Table TBL_EMP2이(가) 생성되었습니다.

-- 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_EMP2';
/*
OWNER        CONSTRAINT_NAME      TABLE_NAME      C COLUMN_NAME      SEARCH_CONDITION      DELETE_RU
------------ -------------------- --------------- - ---------------- --------------------- ---------
HR           EMP2_SID_PK          TBL_EMP2        P SID                                             
HR           EMP2_JIKWI_ID_FK     TBL_EMP2        R JIKWI_ID                               NO ACTION
*/


--○ FK 지정 실습 ( ③  테이블 생성 이후 제약조건 추가)
CREATE TABLE TBL_EMP3
(
     SID  NUMBER(5)  
   , NAME VARCHAR2(30)
   , JIKWI_ID NUMBER(5) 
);
-- Table TBL_EMP3이(가) 생성되었습니다.


--○ 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_EMP3';
-- ==>> 선택된 행 없음

--○ 제약조건 추가
ALTER TABLE TBL_EMP3
ADD
(
     CONSTRAINT EMP3_SID_PK PRIMARY KEY(SID)
    ,CONSTRAINT EMP3_JIKWI_ID_FK FOREIGN KEY(JIKWI_ID)
                  REFERENCES TBL_JOBS(JIKWI_ID) 
);
-- Table TBL_EMP3이(가) 변경되었습니다.

--○ 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_EMP3';
/*
OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             EMP3_SID_PK                    TBL_EMP3                       P SID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
HR                             EMP3_JIKWI_ID_FK               TBL_EMP3                       R JIKWI_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          NO ACTION
*/


-- 부모 테이블
SELECT *
FROM TBL_JOBS;
/*
OWNER        CONSTRAINT_NAME        TABLE_NAME        C COLUMN_NAME      SEARCH_CONDITION       DELETE_RU
------------ ---------------------- ----------------- - ---------------- ---------------------- ---------
HR           EMP3_SID_PK            TBL_EMP3          P SID                                              
HR           EMP3_JIKWI_ID_FK       TBL_EMP3          R JIKWI_ID                                NO ACTION
*/


-- 자식 테이블
SELECT *
FROM TBL_EMP1;
/*
      SID NAME                             JIKWI_ID
---------- ------------------------------ ----------
         1 마이콜                                  1
         2 도우너                                  2
         3 희동이                                  3
         4 고길동                                  4
         5 둘리                                    1
         7 철수                                     

6개 행이 선택되었습니다. 
*/


-- 고길동 부장을 사원으로 직위 변경
UPDATE TBL_EMP1
SET JIKWI_ID = 1
WHERE SID = 4;
-- 1 행 이(가) 업데이트되었습니다.

-- 자식 테이블 확인
SELECT *
FROM TBL_EMP1;
/*
     SID NAME              JIKWI_ID
---------- --------------- ----------
         1 마이콜                   1
         2 도우너                   2
         3 희동이                   3
         4 고길동                   1
         5 둘리                     1
         7 철수                      

6개 행이 선택되었습니다. 
*/

-- 커밋
COMMIT;
-- 커밋 완료.

-- 부모 테이블(TBL_JOBS)의 [부장] 데이터를 참조하고 있는
-- 자식 테이블(TBL_EMP1)의 데이터가 존재하지 않는 상황.

-- 이와 같은 상황에서 부모 테이블()의
-- 부장 데이터 삭제
SELECT *
FROM TBL_JOBS
WHERE JIKWI_ID = 4;
/*
JIKWI_ID JIKWI_NAME                    
---------- ------------------------------
         4 부장    
*/

DELETE
FROM TBL_JOBS
WHERE JIKWI_ID = 4;
-- 1 행 이(가) 삭제되었습니다.


-- 부모 테이블 확인
SELECT *
FROM TBL_JOBS;
/*

  JIKWI_ID JIKWI_NAME                    
---------- ------------------------------
         1 사원                          
         2 대리                          
         3 과장    
*/

-- 커밋
COMMIT;
-- 커밋 완료.

-- 자식 테이블 확인
SELECT *
FROM TBL_EMP1;
/*
   SID NAME           JIKWI_ID
---------- ------------ ----------
         1 마이콜                1
         2 도우너                2
         3 희동이                3
         4 고길동                1
         5 둘리                  1
         7 철수                   

6개 행이 선택되었습니다. 
*/


--○ 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_EMP1';
/*

OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             SYS_C007086                    TBL_EMP1                       P SID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
HR                             SYS_C007087                    TBL_EMP1                       R JIKWI_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          NO ACTION

*/

-- 제약조건 제거
-- 제약조건명 : SYS_C007087
ALTER TABLE TBL_EMP1
DROP CONSTRAINT SYS_C007087;
-- Table TBL_EMP1이(가) 변경되었습니다.

--○ 제약조건 제약 후 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_EMP1';
/*

OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             SYS_C007086                    TBL_EMP1                       P SID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
*/


--▣  『ON DELETE CASCADE』 옵션이 포함된 내용으로 제약조건 다시 지정
ALTER TABLE TBL_EMP1
ADD CONSTRAINT EMP1_JIKWI_ID_FK FOREIGN KEY(JIKWI_ID)
               REFERENCES TBL_JOBS(JIKWI_ID)
               ON DELETE CASCADE;              --CHECK~!!!
-- Table TBL_EMP1이(가) 변경되었습니다.



--○ 제약조건 제약 후 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_EMP1';
/*

OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             SYS_C007086                    TBL_EMP1                       P SID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
HR                             EMP1_JIKWI_ID_FK               TBL_EMP1                       R JIKWI_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          CASCADE  
*/




-------------------------------------------------------------------------
--▣▣▣  NOT NULL (NN:CK:C) ▣▣▣----
-- 1. 테이블에서 지정한 컬럼의 데이터가 NULL 인 상태를 갖지 못하도록 하는 제약조건.

-- 2. 형식 및 구조 (컬럼 레벨의 형식 권장)
--  ① 컬럼 레벨의 형식
--     컬럼명 데이터타입 [CONSTRAINT CONSTRAINT명] NOT NULL

--  ② 테이블 레벨의 형식
--    컬럼명 데이터타입,
--    컬럼명 데이터타입,
--    CONSTRAINT CONSTRAINT명 CHECK(컬럼명 IS NOT NULL)
  
-- 3. 기존에 생성되어 있는 테이블에 NOT NULL 제약조건을 추가할 경우
--    ADD 보다 MODIFY 절이 더 많이 사용된다.

-- ALTER TABLE 테이블명
-- MODIFY 컬럼명 데이터타입 NOT NULL;

-- 4. 기존 테이블에 데이터가 이미 들어있지 않은 컬럼( → NULL 인 상태)을
--   NOT NULL 제약조건을 갖게끔 수정하는 경우에는 에러가 발생한다.

--○ NOT NULL 지정 실습(1. 컬럼 레벨의 형식)
CREATE TABLE TBL_TEST11
(
     COL1 NUMBER(5)     PRIMARY KEY
  ,  COL2 VARCHAR2(20)  NOT NULL
);
-- Table TBL_TEST11이(가) 생성되었습니다.


-- 데이터 입력
INSERT INTO TBL_TEST11(COL1, COL2) VALUES(1, 'TEST');
INSERT INTO TBL_TEST11(COL1, COL2) VALUES(2, 'ABCD');
INSERT INTO TBL_TEST11(COL1, COL2) VALUES(3, NULL);   --> 에러 발생
INSERT INTO TBL_TEST11(COL1, COL2) VALUES(3, 'NULL');
INSERT INTO TBL_TEST11(COL1) VALUES(4); ----------------> 에러 발생

SELECT *
FROM TBL_TEST11;
/*
      COL1 COL2                
---------- --------------------
         1 TEST                
         2 ABCD                
         3 NULL                
*/


COMMIT;
-- 커밋 완료.

--○ 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST11';
/*

OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             SYS_C007093                    TBL_TEST11                     C COL2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "COL2" IS NOT NULL                                                                        
HR                             SYS_C007094                    TBL_TEST11                     P COL1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

*/

--○ NOT NULL 지정 실습(2. 테이블 레벨의 형식)
-- 테이블 생성
CREATE TABLE TBL_TEST12
(
     COL1 NUMBER(5)     
  ,  COL2 VARCHAR2(20)  
  , CONSTRAINT TEST12_COL1_PK PRIMARY KEY(COL1)
  , CONSTRAINT TEST12_COL2_CK CHECK(COL2 IS NOT NULL)
);
-- Table TBL_TEST12이(가) 생성되었습니다.

--○ 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST12';
/*

OWNER                          CONSTRAINT_NAME                TABLE_NAME                     C COLUMN_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      SEARCH_CONDITION                                                                 DELETE_RU
------------------------------ ------------------------------ ------------------------------ - ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ---------
HR                             TEST12_COL2_CK                 TBL_TEST12                     C COL2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             COL2 IS NOT NULL                                                                          
HR                             TEST12_COL1_PK                 TBL_TEST12                     P COL1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
*/

--○ NOT NULL 지정 실습(3. 테이블 생성 이후 제약조건 추가)
-- 테이블 생성
CREATE TABLE TBL_TEST13
(
     COL1 NUMBER(5)     
  ,  COL2 VARCHAR2(20)  
);
-- Table TBL_TEST13이(가) 생성되었습니다.

--○ 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST13';
-- 선택된 행 없음

--○ 제약조건 추가
ALTER TABLE TBL_TEST13
ADD
( CONSTRAINT TEST13_COL1_PK PRIMARY KEY(COL1)
, CONSTRAINT TEST13_COL2_CK CHECK(COL2 IS NOT NULL) 
);
-- Table TBL_TEST13이(가) 변경되었습니다.

--○ 제약조건 추가 후 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST13';
/*

OWNER      CONSTRAINT_NAME    TABLE_NAME    C COLUMN_NAME        SEARCH_CONDITION          DELETE_RU
---------- ------------------ ------------- - ------------------ ------------------------- ---------
HR         TEST13_COL1_PK     TBL_TEST13    P COL1                                                  
HR         TEST13_COL2_CK     TBL_TEST13    C COL2               COL2 IS NOT NULL                   
*/

--※ NOT NULL 제약조건만 추가하는 경우
-- 다음과 같은 형태로 처리하는 것도 가능하다.
-- 테이블 생성
CREATE TABLE TBL_TEST14
(
     COL1 NUMBER(5)     
  ,  COL2 VARCHAR2(20) 
  , CONSTRAINT TEST14_COL1_PK PRIMARY KEY(COL1) 
);
-- Table TBL_TEST14이(가) 생성되었습니다.


-- COL2 에 NOT NULL 제약조건 추가
ALTER TABLE TBL_TEST14 MODIFY COL2 NOT NULL;
-- Table TBL_TEST14이(가) 생성되었습니다.

--○ 제약조건 변경 후 제약조건 확인
SELECT *
FROM VIEW_CONSTCHECK
WHERE TABLE_NAME='TBL_TEST14';
/*

OWNER     CONSTRAINT_NAME    TABLE_NAME    C COLUMN_NAME       SEARCH_CONDITION          DELETE_RU
--------- ------------------ ------------- - ----------------- ------------------------- ---------
HR        TEST14_COL1_PK     TBL_TEST14    P COL1                                                 
HR        SYS_C007100        TBL_TEST14    C COL2              "COL2" IS NOT NULL                 
*/

--※  컬럼 레벨에서 NOT NULL 제약조건을 지정한 테이블
DESC TBL_TEST11;
/*
이름   널?       유형           
---- -------- ------------ 
COL1 NOT NULL NUMBER(5)    
COL2 NOT NULL VARCHAR2(20) 
*/
-- ==>>> DESC 명령을 통해 COL2 컬럼이 NOT NULL 인 상태가 확인되는 상황. ★ ★ ★ 

--※  테이블 레벨에서 NOT NULL 제약조건을 지정한 테이블
DESC TBL_TEST12;
/*
이름   널?       유형           
---- -------- ------------ 
COL1 NOT NULL NUMBER(5)    
COL2          VARCHAR2(20)
*/
-- ==>>> DESC 명령을 통해 COL2 컬럼이 NOT NULL 인 상태가 확인되지 않는상황. ★ ★ ★ 


--※  테이블 생성 이후 ADD를 통해  NOT NULL 제약조건을 지정한 테이블
DESC TBL_TEST13;
/*
이름   널?       유형           
---- -------- ------------ 
COL1 NOT NULL NUMBER(5)    
COL2          VARCHAR2(20) 
*/
-- ==>>> DESC 명령을 통해 COL2 컬럼이 NOT NULL 인 상태가 확인되지 않는상황. ★ ★ ★ 


--※  테이블 생성 이후 MODIFY를 통해  NOT NULL 제약조건을 지정한 테이블
DESC TBL_TEST14;
/*
이름   널?       유형           
---- -------- ------------ 
COL1 NOT NULL NUMBER(5)    
COL2 NOT NULL VARCHAR2(20) 
*/
-- ==>>> DESC 명령을 통해 COL2 컬럼이 NOT NULL 인 상태가 확인되는 상황. ★ ★ ★ 

---------------------------------------------------------------------------------
--▣▣▣  DEFAULT 표현식 ▣▣▣--
-- 1. INSERT 와 UPDATE 구문에서
--     사용자가 전달하는 특정 값이 아닌
--     기본적으로 설정된 값을 입력하거나 수정할 수 있도록 처리할 수 있다.
       
-- 2. 형식 및 구조
--    컬럼명 데이터타입 DEFAULT 기본값
      
-- 3. INSERT 명령 시 해당 컬럼에 입력된 값을 할당하지 않거나
--    DEFAULT 키워드를 활용하여 기본적으로 설정된 값을 입력하도록 할 수 있다.
       
-- 4. DEFAULT 키워드와 다른 제약(NOT NULL 등) 표기가 같이 오는 경우
--    DEFAULT 키워드를 먼저 표기(작성)할 것을 권장한다.
       
--○ DEFAULT 표현식 실습
-- 테이블 생성
CREATE TABLE TBL_BOARD                                    -- 게시판 테이블 생성
( SID         NUMBER             PRIMARY KEY              -- 게시물 번호 -> 식별자(자동 증가)
, NAME        VARCHAR2(30)                                -- 게시물 작성자
, CONTENTS    VARCHAR2(2000)                              -- 게시물 내용
, WRITEDAY    DATE              DEFAULT SYSDATE NOT NULL  -- 게시물 작성일(현재 날짜시간 자동 입력)
, COMMENTS    NUMBER            DEFAULT 0       NOT NULL  -- 게시물 댓글 갯수(기본값 0)
, COUNTS      NUMBER            DEFAULT 0       NOT NULL  -- 게시물 조회수(기본값 0) -- 사용하지 않는 알고리즘...
);
-- Table TBL_BOARD이(가) 생성되었습니다.

-- NOT NULL DEFAULT SYSDATE  --> DEFAULT 적용이 안되는 경우 발생.....

-- ※ SID 를 자동 증가 값으로 운영하려면 시퀀스(SEQUENCE) 객체가 필요하다.
--    자동으로 입력되는 컬럼은 사용자가 입력해야 하는 항목에서
--    제외시킬 수 있다.

-- 시퀀스 삭제
DROP SEQUENCE SEQ_BOARD;

-- 시퀀스 생성
CREATE SEQUENCE SEQ_BOARD
NOCACHE;
-- Sequence SEQ_BOARD이(가) 생성되었습니다.

-- 날짜 형식 관련 세션 설정 변경
ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS';
-- Session이(가) 변경되었습니다.


-- 게시물 작성
INSERT INTO TBL_BOARD(SID, NAME, CONTENTS, WRITEDAY, COMMENTS, COUNTS)
VALUES(SEQ_BOARD.NEXTVAL, '한국', '오라클 DEFAULT 표현식 실습', TO_DATE('2025-07-09 16:06:23', 'YYYY-MM-DD HH24:MI:SS'), 0, 0);
-- 1 행 이(가) 삽입되었습니다.

INSERT INTO TBL_BOARD(SID, NAME, CONTENTS, WRITEDAY, COMMENTS, COUNTS)
VALUES(SEQ_BOARD.NEXTVAL, '한국', '오라클 DEFAULT 표현식 실습', SYSDATE, 0, 0);
-- 1 행 이(가) 삽입되었습니다.

INSERT INTO TBL_BOARD(SID, NAME, CONTENTS, WRITEDAY, COMMENTS, COUNTS)
VALUES(SEQ_BOARD.NEXTVAL, '미국', '오라클 DEFAULT 표현식 실습-2', DEFAULT, DEFAULT, DEFAULT);
-- 1 행 이(가) 삽입되었습니다.

INSERT INTO TBL_BOARD(SID, NAME, CONTENTS)
VALUES(SEQ_BOARD.NEXTVAL, '호주', '오라클 DEFAULT 표현식 실습-4');
-- 1 행 이(가) 삽입되었습니다.


-- 데이터 확인
SELECT *
FROM TBL_BOARD;
/*

       SID NAME                           CONTENTS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         WRITEDAY              COMMENTS     COUNTS
---------- ------------------------------ -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------- ---------- ----------
         1 한국                           오라클 DEFAULT 표현식 실습                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2025-07-09 16:06:23          0          0
         2 한국                           오라클 DEFAULT 표현식 실습                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2025-07-09 16:12:00          0          0
         3 미국                           오라클 DEFAULT 표현식 실습-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       2025-07-09 16:13:09          0          0
         4 호주                           오라클 DEFAULT 표현식 실습-4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       2025-07-09 16:22:06          0          0
*/

-- 커밋
COMMIT;
-- 커밋 완료.


--▣ DEFAULT 표현식 조회(학인)
SELECT TABLE_NAME, COLUMN_NAME, DATA_TYPE, DATA_DEFAULT
FROM USER_TAB_COLUMNS
WHERE TABLE_NAME='TBL_BOARD';
/*

TABLE_NAME                     COLUMN_NAME                    DATA_TYPE                                                                                                  DATA_DEFAULT                                                                    
------------------------------ ------------------------------ ---------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------
TBL_BOARD                      SID                            NUMBER                                                                                                                                                                                     
TBL_BOARD                      NAME                           VARCHAR2                                                                                                                                                                                   
TBL_BOARD                      CONTENTS                       VARCHAR2                                                                                                                                                                                   
TBL_BOARD                      WRITEDAY                       DATE                                                                                                       SYSDATE                                                                         
TBL_BOARD                      COMMENTS                       NUMBER                                                                                                     0                                                                               
TBL_BOARD                      COUNTS                         NUMBER                                                                                                     0                                                                               
6개 행이 선택되었습니다. 
*/


--▣ 테이블 생성 이후 DEFAULT 표현식 추가 / 변경
/*
  ALTER TABLE 테이블명
  MODIFY 컬럼명 [자료형] DEFAULT 기본값;
*/

--▣ 생성된 DEFAULT 표현식 제거(삭제)
/*
  ALTER TABLE 테이블명
  MODIFY 컬럼명 [자료형] DEFAULT NULL;
*/



-- ### --▣ --※ --○ ★ 『』 ? ▣ ◀▶ ▼ ▲ ⓐ ⓑ ① ② ③ ④ ⑤ ⑥ ⑦ ⑧ ⑨ ⑩  →   ←  ↓  …  ： º↑ /* */  ─ ┃ ┛┯ ┐┘ ￦
--/*▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼*/
--/*================[ 7월 XX일(금) ]========================*/

-----------------[ 강사님 풀이 - START ] ------------------------------
-----------------[  강사님 풀이 - END  ] ------------------------------

-----------------[ 실습 - START ] ----------------------------
-----------------[  실습 - END  ] ----------------------------
